#!/usr/bin/env bash

parse_args() {
  NUKE_PATHS=()
  while [[ $# -gt 0 ]]; do
    case "$1" in
      *)
        NUKE_PATHS+=("$1")
        shift
      ;;
    esac
  done
}

main() {
  print_status "Nuking $SERVICE_KEY..."
  parse_args "$@"
  cd "$SERVICE_DIR"

  ./bin/down
  docker compose rm -f

  for dir in "${NUKE_PATHS[@]}"; do
    echo "Nuking $dir"
    sudo rm -rf "./$dir"
  done
  print_success "Done."
}

source "$(cd "$(dirname "${BASH_SOURCE[0]}")/../../.." && pwd)/lib/cli.sh"